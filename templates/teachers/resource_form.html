{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>إضافة مرجع</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <style>
    html, body { height: auto; overflow-y: auto; }
    body { font-family: "Tajawal", system-ui, Arial, sans-serif; background:#f8f9fa; margin:0; }

    .container {
      max-width: 720px;
      margin: 40px auto;
      padding: 24px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.08);
      padding-bottom: 120px; /* 🔑 يمنع الفوتر من تغطية المحتوى */
    }

    h2 { margin-top:0; color:#2c3e50; font-size:22px; }

    .hint {
      background:#f1f5f9;
      border:1px solid #e2e8f0;
      border-radius:10px;
      padding:12px;
      margin:14px 0;
      color:#374151;
      line-height:1.7;
      font-size:14px;
    }

    form p { margin-bottom:14px; }
    label { display:block; margin-bottom:6px; font-weight:600; color:#34495e; }
    input, select, textarea {
      width:100%; padding:10px; border-radius:8px; border:1px solid #ccc;
      font-family:inherit; font-size:15px;
    }
    input[type="file"] { padding:4px; }

    button {
      padding:10px 16px; border:none; border-radius:8px;
      background:#0d6efd; color:#fff; font-size:15px; cursor:pointer;
    }
    button:hover { background:#0b5ed7; }

    .back { display:inline-block; margin-top:16px; text-decoration:none; color:#0d6efd; }

    .tips { font-size:13px; color:#6b7280; margin-top:-6px; margin-bottom:10px; }

    /* ✅ رسائل Django messages */
    .messages { margin: 12px 0 18px; }
    .messages .success {
      background:#d1fae5; border:1px solid #10b981; color:#065f46;
      padding:10px; border-radius:8px; margin-bottom:8px;
    }
    .messages .error {
      background:#fee2e2; border:1px solid #ef4444; color:#991b1b;
      padding:10px; border-radius:8px; margin-bottom:8px;
    }
    .messages .warning {
      background:#fef3c7; border:1px solid #f59e0b; color:#92400e;
      padding:10px; border-radius:8px; margin-bottom:8px;
    }
    .messages .info {
      background:#e0f2fe; border:1px solid #38bdf8; color:#075985;
      padding:10px; border-radius:8px; margin-bottom:8px;
    }
  </style>
</head>
<body>
  {% include "header.html" %}

  <main class="container">
    <h2>📚 إضافة مرجع/كتاب للمقرر: <strong>{{ course.title }}</strong></h2>

    <!-- 🔔 عرض رسائل النجاح/الأخطاء/التحذير -->
    {% if messages %}
      <div class="messages" role="alert" aria-live="polite">
        {% for message in messages %}
          <div class="{{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}

    <div class="hint">
      ✅ يمكنك رفع <b>ملف</b> (PDF/Doc/Zip …) <u>أو</u> إدخال <b>رابط خارجي</b> يبدأ بـ <code>https://</code>.
      <br>اختياريًا: يمكن حفظ المرجع بدون ملف/رابط وسيُعرض كترويسة مع ملاحظة.
    </div>

    <form method="post" enctype="multipart/form-data" novalidate>
      {% csrf_token %}
      {{ form.as_p }}
      <div class="tips">إن أدخلت رابطًا، تأكد أن يبدأ بـ <code>https://</code>.</div>
      <button type="submit">💾 حفظ المرجع</button>
    </form>

    <a href="{% url 'teachers:course_detail' course.id %}" class="back">⬅ رجوع لتفاصيل المقرر</a>
  </main>

  {% include "footer.html" %}
</body>
</html>
