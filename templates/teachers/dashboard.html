{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>لوحة المعلم</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {font-family:'Tajawal',sans-serif;background:#f8fafc;margin:0;color:#333;}
    .container {max-width:1200px;margin:auto;padding:30px;}

    h2 {margin-bottom:10px;font-size:24px;}
    .muted {color:#6b7280;font-size:14px;}

    /* كروت الإحصائيات */
    .stats {display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin:25px 0;}
    .stat-card {background:#fff;padding:20px;border-radius:14px;box-shadow:0 4px 12px rgba(0,0,0,.05);display:flex;align-items:center;gap:14px;}
    .stat-icon {font-size:26px;padding:12px;border-radius:12px;color:#fff;}
    .stat-info h3 {margin:0;font-size:18px;}
    .stat-info p {margin:4px 0 0;font-size:14px;color:#666;}
    .courses-icon {background:#6366f1;}
    .lessons-icon {background:#10b981;}
    .students-icon {background:#f59e0b;}

    /* المقررات */
    .section-title {margin:30px 0 15px;font-size:20px;color:#111;}
    .grid {display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px;}
    .card {background:#fff;border-radius:14px;padding:18px;box-shadow:0 2px 8px rgba(0,0,0,.05);}
    .card h3 {margin:0 0 10px;font-size:18px;color:#222;}
    .chips {display:flex;flex-wrap:wrap;gap:6px;margin-bottom:10px;}
    .chip {background:#f3f4f6;padding:4px 10px;border-radius:999px;font-size:13px;color:#374151;}
    .muted-text {color:#6b7280;font-size:14px;margin:0 0 12px;}
    .actions {display:flex;gap:10px;flex-wrap:wrap;}
    .btn {padding:8px 14px;border-radius:10px;text-decoration:none;font-size:14px;font-weight:600;display:inline-flex;align-items:center;gap:6px;transition:.2s;}
    .btn-primary {background:#2563eb;color:#fff;}
    .btn-outline {background:#fff;border:1px solid #2563eb;color:#2563eb;}
    .btn-outline.green {border-color:#10b981;color:#10b981;}
    .btn-outline.blue {border-color:#0ea5e9;color:#0ea5e9;}
    .btn:hover {filter:brightness(0.95);}
    .empty {color:#999;margin:15px 0;}

    hr {margin:30px 0;border:0;border-top:1px solid #e5e7eb;}
    .logout {display:inline-block;padding:10px 18px;border-radius:10px;background:#ef4444;color:#fff;text-decoration:none;}
    .logout:hover {background:#dc2626;}
  </style>
</head>
<body>

  {% include "header.html" %}

  <div class="container">
    <h2>👨‍🏫 لوحة المعلّم — مرحبًا {{ teacher_name }}</h2>
    {% if user.email %}
      <p class="muted"><i class="fa-solid fa-envelope"></i> {{ user.email }}</p>
    {% endif %}

    <!-- كروت الإحصائيات -->
    <div class="stats">
      <div class="stat-card">
        <div class="stat-icon courses-icon"><i class="fa-solid fa-book"></i></div>
        <div class="stat-info">
          <h3>{{ total_courses }}</h3>
          <p>عدد المقررات</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon lessons-icon"><i class="fa-solid fa-video"></i></div>
        <div class="stat-info">
          <h3>{{ total_lessons }}</h3>
          <p>عدد المحاضرات</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon students-icon"><i class="fa-solid fa-user-graduate"></i></div>
        <div class="stat-info">
          <h3>{{ total_students }}</h3>
          <p>عدد الطلاب</p>
        </div>
      </div>
    </div>

    <!-- مقرراتي -->
    <h3 class="section-title">📚 مقرراتي</h3>
    {% if courses %}
      <div class="grid">
        {% for c in courses %}
          <div class="card">
            <h3>{{ c.title }}</h3>
            <div class="chips">
              {% if c.subject %}<span class="chip">{{ c.subject.name }}</span>{% endif %}
              {% if c.subject.stage %}<span class="chip">{{ c.subject.stage }}</span>{% endif %}
              {% if c.duration_days %}<span class="chip">{{ c.duration_days }} يومًا</span>{% endif %}
              <span class="chip">{% if c.is_active %}نشط{% else %}متوقف{% endif %}</span>
              <span class="chip">👥 {{ c.students_total|default:0 }}</span>
            </div>
            {% if c.description %}
              <p class="muted-text">{{ c.description|truncatechars:120 }}</p>
            {% endif %}
            <div class="actions">
              <a href="{% url 'teachers:course_detail' c.id %}" class="btn btn-primary"><i class="fa-solid fa-eye"></i> تفاصيل</a>
              <a href="{% url 'teachers:add_lesson' c.id %}" class="btn btn-outline green"><i class="fa-solid fa-plus"></i> محاضرة</a>
              <a href="{% url 'teachers:add_resource' c.id %}" class="btn btn-outline blue"><i class="fa-solid fa-book-open"></i> مرجع/كتاب</a>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="empty">🚫 لا توجد مقررات حالياً.</p>
    {% endif %}

    <hr>
    <a href="{% url 'logout' %}" class="logout"><i class="fa-solid fa-right-from-bracket"></i> تسجيل الخروج</a>
  </div>

  {% include "footer.html" %}
</body>
</html>
