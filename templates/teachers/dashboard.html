{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>لوحة الطالب</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>

  {% include "header.html" %}

  <main style="padding:30px;max-width:900px;margin:auto">
    <h2>مرحبًا بك، {{ user.get_full_name|default:user.username }}</h2>

    <p><strong>البريد:</strong> {{ user.email }}</p>

    {% if student %}
      {% if student.stage %}
        <p><strong>المرحلة الدراسية:</strong> {{ student.stage }}</p>
      {% endif %}

      <hr>

      <h3>الدورات المسجّل بها:</h3>
      {% with enrolls=student.enrollments.all %}
        {% if enrolls %}
          <ul>
            {% for en in enrolls %}
              <li style="margin-bottom:6px">
                {{ en.course.title }}
                {% if en.teams_link and en.teams_link|slice:":8" == "https://" %}
                  — <a href="{{ en.teams_link }}" target="_blank" rel="noopener">انضم الآن</a>
                {% elif en.course.teams_link and en.course.teams_link|slice:":8" == "https://" %}
                  — <a href="{{ en.course.teams_link }}" target="_blank" rel="noopener">انضم الآن</a>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p>لا توجد دورات حالياً.</p>
        {% endif %}
      {% endwith %}
    {% else %}
      <p>لم يتم ربط حسابك ببيانات طالب بعد.</p>
    {% endif %}

    <hr>
    <a href="{% url 'logout' %}" class="btn btn-danger">تسجيل الخروج</a>
  </main>

  {% include "footer.html" %}

</body>
</html>
