{% extends "students/base.html" %}
{% load static %}

{% block title %}ğŸ“˜ {{ course.title }}{% endblock %}

{% block content %}
<main dir="rtl" class="wrapper" style="max-width:1150px;margin:0 auto;padding:28px 16px;">

  <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† + Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© -->
  <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:20px;">
    <h1 style="margin:0;font-size:26px;color:#1f2937;display:flex;align-items:center;gap:8px;">
      ğŸ“– {{ course.title }}
    </h1>
    <a href="{% url 'students:dashboard' %}"
       style="text-decoration:none;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:10px;padding:8px 14px;font-size:14px;">
      â¬…ï¸ Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø¯ÙˆØ±Ø§ØªÙŠ
    </a>
  </div>

  <!-- ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù -->
  {% if course.cover_image_url %}
    <div style="margin-bottom:20px;">
      <img src="{{ course.cover_image_url }}" alt="ØºÙ„Ø§Ù {{ course.title }}"
           style="width:100%;max-height:320px;object-fit:cover;border-radius:14px;border:1px solid #e5e7eb;">
    </div>
  {% endif %}

  <!-- ØªØ®Ø·ÙŠØ·: Ø¹Ù…ÙˆØ¯ÙŠÙ† -->
  <div style="display:grid;grid-template-columns:1fr 320px;gap:20px;align-items:start;">

    <!-- Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ -->
    <div style="display:flex;flex-direction:column;gap:16px;">

      <!-- ÙˆØµÙ Ø§Ù„Ø¯ÙˆØ±Ø© -->
      <section class="card">
        <h2>ğŸ“Œ ÙˆØµÙ Ø§Ù„Ø¯ÙˆØ±Ø©</h2>
        {% if course.description %}
          <p>{{ course.description|linebreaksbr }}</p>
        {% else %}
          <p class="muted">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©.</p>
        {% endif %}
      </section>

      <!-- Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª -->
      <section class="card">
        <h2>ğŸ“ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</h2>
        <ul class="list">
          {% for l in lessons %}
            <li class="item">
              <b>#{{ l.order }} â€” {{ l.title }}</b>
              <div class="muted" style="margin-top:6px">
                {% if l.recording_url %}
                  ğŸ¥ <a href="{{ l.recording_url }}" target="_blank">Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</a>
                {% elif l.video_file %}
                  ğŸ¥ <a href="{{ l.video_file.url }}" target="_blank">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</a>
                {% endif %}
                {% if l.slide_url %}
                  &nbsp;|&nbsp; ğŸ“‘ <a href="{{ l.slide_url }}" target="_blank">Ø´Ø±Ø§Ø¦Ø­</a>
                {% elif l.slide_file %}
                  &nbsp;|&nbsp; ğŸ“‘ <a href="{{ l.slide_file.url }}" target="_blank">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­</a>
                {% endif %}
              </div>
              {% if l.content %}
                <p style="margin:8px 0 0;color:#444">{{ l.content|linebreaksbr }}</p>
              {% endif %}
            </li>
          {% empty %}
            <li class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø¨Ø¹Ø¯.</li>
          {% endfor %}
        </ul>
      </section>

      <!-- Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ -->
      <section class="card">
        <h2>ğŸ“š Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</h2>
        <ul class="list">
          {% for r in resources %}
            <li class="item">
              <b>{{ r.title }}</b>
              {% if r.external_link %}
                â€” <a href="{{ r.external_link }}" target="_blank">Ø±Ø§Ø¨Ø· Ø®Ø§Ø±Ø¬ÙŠ</a>
              {% endif %}
              {% if r.file %}
                â€” <a href="{{ r.file.url }}" target="_blank">ØªØ­Ù…ÙŠÙ„</a>
              {% endif %}
              {% if r.get_kind_display %}
                â€” <span class="muted">{{ r.get_kind_display }}</span>
              {% endif %}
            </li>
          {% empty %}
            <li class="muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±Ø§Ø¬Ø¹ Ø¨Ø¹Ø¯.</li>
          {% endfor %}
        </ul>
      </section>

    </div>

    <!-- Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
    <aside class="card">
      <h3>ğŸ¯ Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØµÙˆÙ„</h3>
      {% if enrollment %}
        <div style="color:#065f46;background:#ecfdf5;border:1px solid #a7f3d0;border-radius:10px;padding:8px;margin-bottom:12px;">
          âœ… Ø£Ù†Øª Ù…Ø³Ø¬Ù‘Ù„ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©
        </div>
      {% else %}
        <div style="color:#7c2d12;background:#fffbeb;border:1px solid #fde68a;border-radius:10px;padding:8px;margin-bottom:12px;">
          âš ï¸ ØºÙŠØ± Ù…Ø³Ø¬Ù‘Ù„
        </div>
      {% endif %}

      {% if course.teams_link %}
        <a href="{{ course.teams_link }}" target="_blank" rel="noopener noreferrer"
           style="display:block;text-align:center;padding:10px;border-radius:10px;background:#2563eb;color:#fff;font-weight:700;text-decoration:none;margin-bottom:8px;">
          ğŸš€ Ø¯Ø®ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø± (Teams)
        </a>
      {% endif %}

      <hr style="border:none;border-top:1px solid #f1f5f9;margin:12px 0">
      <div class="muted">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: {% now "Y-m-d H:i" %}</div>
    </aside>
  </div>
</main>

<style>
  .card{background:#fff;border:1px solid #e7eef5;border-radius:14px;padding:18px;box-shadow:0 3px 14px rgba(0,0,0,.04)}
  .card h2{margin:0 0 10px;font-size:18px;color:#111827}
  .list{list-style:none;padding:0;margin:0}
  .item{background:#fafafa;border:1px solid #e5e7eb;border-radius:12px;padding:12px;margin-bottom:10px}
  .muted{color:#6b7280;font-size:14px}
</style>
{% endblock %}
